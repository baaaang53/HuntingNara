<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>$$헌팅나라$$</title>

    <!-- bootstrap including jquery -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script type = "text/javascript">
        function uploadReport() {
            const form = $('<form>', {action: "/upload/report", method: 'post', enctype: "multipart/form-data"});
            form.append($('fieldset.asking input[type="file"]'));
            $(document.body).append(form)
        }


            //해당 의뢰의 state는 c_requesting으로 바꾸기

        function ask() {
            $.ajax({
                type: 'get',
                url: '/request/askcomplete',
                data: $('#req_reg').serialize(),
                success: function(data, status) {
                    console.log('onsuccess');
                    console.log(data);
                    if (data.success) {
                        alert('요청이 완료되었습니다');
                        location.href = '../';
                    } else {
                        alert('요청이 완료되지 않았습니다');
                        location.href = './register';
                    }
                },
                error: function(error) {
                    console.log(error);
                    alert('요청 완료되지 않았습니다');
                    location.href = './register';
                }
            });
        }
    </script>
</head>
<body>
    <div class="ask_complete_form">
        <h1>&emsp;&emsp; 완료 요청하기</h1><br><br>
        <form id="reporting"> <!--action="/user/register" method="post" enctype="multipart/form-data" onsubmit="submitForm();"-->
            <fieldset class="asking" form="reporting">
                보고서 :
                <input type="file" name="report" onchange="uploadReport();"><br>
            </fieldset>
            &emsp;<button type="button" onclick="ask();">요청하기</button>
        </form>
    </div>
</body>
</html>